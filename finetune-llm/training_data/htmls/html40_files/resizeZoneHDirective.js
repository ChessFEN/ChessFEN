angular.module("chessStories").directive("appResizeZoneH",["$timeout",function(t){return{restrict:"EA",scope:!1,template:'<div class="resize-wrap"><div class="handle"><div><div></div></div></div></div>',link:function(e,o,a){var i=!1,n=$(o),s=n.parent(),c=s.children(".header-bottom").height(),h=s.children(".top-part"),p=s.children(".bottom-part");n.offset().top;function r(t){var a=h.height(),i=p.height(),r=n.height(),d=s.height();if(c+(a-=t)+r+(i+=t)>d&&(i=d-(c+a+r)),a<=250||i<=80)return!1;var g=100*i/d;return h.css("height","calc(100% - "+g+"% - "+r+"px - "+c+"px)"),p.css("height",g+"%"),o.attr("aria-valuenow",g),e.bottom_pct=g,!0}e.bottom_pct=null,"r"===n.attr("data-side")&&h.css("height","100%"),e.$on("game-panel-pos-changed",function(o,a){a.newval!==a.oldval&&t(function(){if(e.mobile)return h.css("height",""),void p.css("height","");n.attr("data-side")===$(".pgn-area").attr("data-side")?e.bottom_pct?(h.css("height","calc(100% - "+e.bottom_pct+"% - "+n.height()+"px)"),p.css("height",e.bottom_pct+"%")):(h.css("height",""),p.css("height","")):h.css("height","100%"),0!==a.newval&&0!==a.oldval||e.$broadcast("size-changed")},300)}),n.on("mousedown",function(t){t.preventDefault(),1==t.buttons&&(i=!0)}),n.on("mouseup",function(t){i=!1}),$(window).on("mouseup",function(t){i=!1}),$(window).on("mousemove",function(t){i&&(t.preventDefault(),r(n.offset().top+n.height()/2-t.pageY)&&(e.$apply(),0!==e.game_panel_pos&&void 0!==e.game_panel_pos||e.$broadcast("size-changed")))}),n.on("touchmove",function(t){r(n.offset().top-t.originalEvent.changedTouches[0].pageY)&&(e.$apply(),0===e.game_panel_pos&&e.$broadcast("size-changed"))})}}}]);
