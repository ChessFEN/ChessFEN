var contactCtrl=["$scope","$rootScope","contactUsService","i18nService","$timeout","Kbd",function(e,t,n,o,c,s){var i=this,l=o.phrases;this.model={email:"",subject:"",text:"",send_text:""},this.cancel=function(){i.closeDlg()};var r=function(t,n,o){e.popupMsg.showText(t,n,o)};this.send=function(){if(i.model.subject||i.model.text){r(l.sending_msg,!0);var t=e.currTab.game;i.model.send_text=i.contactDlgVariant+"\n"+(i.model.text||"")+"\n--------\n\nemail: "+i.model.email+"\nanalyzed position: "+(e.currTab.currJob?e.currTab.currJob.fen:"none")+"\ncurrent position: "+e.curr_fen+"\nFEN: "+e.curr_fen+"\ngame origin: "+t.origin+"\n---- PGN: ----\n"+t.as_pgn(),n.send(i.model.subject,i.model.send_text,t.key,function(t,n){t?r(t,!1):(r(l.message_sent_msg,!1),c(function(){var t;t=function(){i.closeDlg(),i.model.subject="",i.model.text=""},e.popupMsg.dismiss(t)},2100))}),console.log("self.model.send_text",i.model.send_text)}else r(l.message_is_empty_msg,!1,1200)},this.closeDlg=function(){e.show_contact_us_dlg=!1},this.keyAction=function(e){e==s.ESC&&i.cancel()}}];chessStories.directive("appContactDlg",[function(){return{restrict:"EA",scope:!1,templateUrl:"/static001767/app/shared/contactDlg/contactDlgView.html",controller:contactCtrl,controllerAs:"contact_dlg"}}]);
