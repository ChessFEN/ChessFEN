chessStories.service("arrowsService",["$rootScope","acctService",function(r,e){var o=this,a=r.currentUser.prefs;return o.arrows_hide=!1,o.arrows_hide_default=!1,o.arrow_opacity_curr=.34,o.arrow_opacity_default=.34,o.selected_arrow_eids=[],o.arrows_opac_override=null,o.arrow_roles={base:{in_prefs:"b",shown:!0,shown_default:!0},threat:{in_prefs:"t",shown:!1,shown_default:!1},findbest:{in_prefs:"f",shown:!1,shown_default:!1},attention:{in_prefs:"a",shown:!1,shown_default:!1},local:{in_prefs:"y",shown:!0,shown_default:!0}},o.select_arrows_by_eids=function(e){if(void 0!==e){var a=o.selected_arrow_eids.sort(),s=!(e.length===a.length&&e.sort().every((r,e)=>r===a[e]));o.selected_arrow_eids=e,s&&r.$emit("arrows_selected",o.selected_arrow_eids)}return _.clone(o.selected_arrow_eids)},{hide_all:function(r){return void 0!==r&&(o.arrows_hide=r),o.arrows_hide},arrows_hide:o.arrows_hide,arrow_curr_opacity:o.arrow_opacity_curr,arrow_opacity:function(r){return r&&0<=r&&r<=1&&(o.arrow_opacity_curr=r),o.arrow_opacity_curr},arrow_roles:o.arrow_roles,select_arrows_by_eids:o.select_arrows_by_eids,get_arrows_opacity_for_display:function(){var r=o.arrows_hide?0:o.arrow_opacity_curr;null!==o.arrows_opac_override&&(r=o.arrows_opac_override);var e=-1,_=-1;return o.selected_arrow_eids.length&&(e=.5*r,_=1-(o.arrows_opac_override?0:Math.pow(1-r,4))),[r,e,_]},get_arrow_roles_disp:function(r){return!!r&&o.arrow_roles[r].shown},set_pref:function(r,_){var s,t,i;a.arr||(a.arr={});var w={};"arrows_hide"===r?(s="h",t=o.arrows_hide_default,i=_,o[r]=_):"arrow_opacity"===r?(s="o",t=o.arrow_opacity_default,i=_,o.arrow_opacity_curr=_):(s=o.arrow_roles[r].in_prefs,t=o.arrow_roles[r].shown_default,o.arrow_roles[r].shown=_,i=_?1:0),w["arr."+s]=_!==t?i:null,e.setUserPrefs(w),o[r]=_},set_opac_override:function(r){o.arrows_opac_override=r}}}]);
