angular.module("chessStories").directive("appMoveMenu",[function(){return{restrict:"EA",scope:!1,templateUrl:"/static001767/app/shared/moveMenu/moveMenuView.html",link:function(o,e,i){o.move_menu.recalc_pos=function(){var i=o.move_menu;i.coords&&(i.position&&"right"!==i.position?"left"===i.position&&e.css("right",window.innerWidth-i.coords[0]+8).css("left",""):e.css("left",i.coords[0]+8).css("right",""),i.coords[1]<150?e.css("top",i.coords[1]):e.css("top",i.coords[1]-114))},o.$watch("move_menu.item",o.move_menu.recalc_pos)},controllerAs:"move_menu",controller:["$scope","$timeout",function(o,e){var i=this;i.shown=!1,i.in_main_line=!1,i.pos_is_stale=!1,i.setModel=function(o,e,t){i.item=o,i.coords=e,i.position=t},i.show=function(){i.in_main_line=o.currTab.game.in_main_line(i.item),i.pos_is_stale&&i.recalc_pos(),i.shown=!0,i.item&&(i.item.alt_active=!0)},i.hide=function(){i.shown=!1,i.item&&(i.item.alt_active=!1)},o.$watchCollection(i.coords,()=>i.pos_is_stale=!0),o.$on("dismiss-popups",function(o,e){i.hide()}),$("#topcontainer").on("click",function(o){i.hide()})}]}}]);
